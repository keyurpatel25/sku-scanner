<!DOCTYPE html>
<html>
<head>
Â  Â  <title>Simple Online Barcode Scanner</title>
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  background-color: #f4f4f9;
Â  Â  Â  Â  }
Â  Â  Â  Â  #reader {
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 500px;
Â  Â  Â  Â  Â  Â  margin: 20px auto;
Â  Â  Â  Â  Â  Â  border: 2px solid #3498db;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  #result-container {
Â  Â  Â  Â  Â  Â  margin-top: 30px;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  background-color: #ecf0f1;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  max-width: 500px;
Â  Â  Â  Â  Â  Â  margin: 30px auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  #result {
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #2c3e50;
Â  Â  Â  Â  Â  Â  word-break: break-all;
Â  Â  Â  Â  Â  Â  min-height: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  #product-image {
Â  Â  Â  Â  Â  Â  max-width: 100%;
Â  Â  Â  Â  Â  Â  height: auto;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  display: none; /* Hide until an image is successfully loaded */
Â  Â  Â  Â  }
Â  Â  Â  Â  h3 {
Â  Â  Â  Â  Â  Â  color: #34495e;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

Â  Â  <h1>ðŸš€ Online Barcode Scanner (Barcode Only)</h1>
Â  Â  <p>Scan a barcode using your device's camera. QR codes are ignored.</p>

Â  Â  <div id="reader"></div>

Â  Â  <div id="result-container">
Â  Â  Â  Â  <h3>Decoded Result:</h3>
Â  Â  Â  Â  <p id="result">Awaiting scan...</p>
Â  Â  Â  Â  <h3>Product Image:</h3>
Â  Â  Â  Â  <img id="product-image" src="" alt="Product Image">
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // --- Image Logic Constants and Elements ---
Â  Â  Â  Â  const BASE_URL_PREFIX = 'https://img.faballey.com/images/Product/';
Â  Â  Â  Â  const BASE_URL_SUFFIX = '/1.jpg';
Â  Â  Â  Â  const IMAGE_EL = document.getElementById('product-image');

Â  Â  Â  Â  // Function to generate the next SKU for A-Z fallback
Â  Â  Â  Â  function getNextSku(sku) {
Â  Â  Â  Â  Â  Â  if (sku.length === 0) return null;
Â  Â  Â  Â  Â  Â  const lastChar = sku.slice(-1);
Â  Â  Â  Â  Â  Â  const prefix = sku.slice(0, -1);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // If the last character is a letter A-Y, increment it
Â  Â  Â  Â  Â  Â  if (lastChar >= 'A' && lastChar < 'Z') {
Â  Â  Â  Â  Â  Â  Â  Â  const nextChar = String.fromCharCode(lastChar.charCodeAt(0) + 1);
Â  Â  Â  Â  Â  Â  Â  Â  return prefix + nextChar;
Â  Â  Â  Â  Â  Â  } else if (lastChar === 'Z') {
Â  Â  Â  Â  Â  Â  Â  Â  // Stop after Z
Â  Â  Â  Â  Â  Â  Â  Â  return null; 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // If the last character is a digit or other, start sequence from A
Â  Â  Â  Â  Â  Â  return prefix + 'A';
Â  Â  Â  Â  }

Â  Â  Â  Â  // Function to check if an image exists and recursively try fallbacks
Â  Â  Â  Â  function checkAndDisplayImage(sku, originalSku) {
Â  Â  Â  Â  Â  Â  const imageUrl = `${BASE_URL_PREFIX}${sku}${BASE_URL_SUFFIX}`;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  IMAGE_EL.src = imageUrl;
Â  Â  Â  Â  Â  Â  IMAGE_EL.alt = `Checking SKU: ${sku}`;

Â  Â  Â  Â  Â  Â  IMAGE_EL.onload = () => {
Â  Â  Â  Â  Â  Â  Â  Â  // Success: Display the found image and stop the check sequence
Â  Â  Â  Â  Â  Â  Â  Â  console.log(`Image found for SKU: ${sku}`);
Â  Â  Â  Â  Â  Â  Â  Â  IMAGE_EL.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  IMAGE_EL.alt = `Product Image for ${sku}`;
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  IMAGE_EL.onerror = () => {
Â  Â  Â  Â  Â  Â  Â  Â  // Failure: Try the next SKU in the fallback sequence
Â  Â  Â  Â  Â  Â  Â  Â  console.warn(`Image failed for SKU: ${sku}`);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  const nextSku = getNextSku(sku);
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if (nextSku && nextSku.slice(-1) <= 'Z') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  checkAndDisplayImage(nextSku, originalSku); // Recursive call
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Exhausted all fallbacks
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("No valid image found after all fallbacks.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  IMAGE_EL.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  IMAGE_EL.alt = "Image not found for any variant.";
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  }


Â  Â  Â  Â  // --- 1. Initialization & Success Handler ---
Â  Â  Â  Â  function onScanSuccess(decodedText, decodedResult) {
Â  Â  Â  Â  Â  Â  // 1. Display the decoded text
Â  Â  Â  Â  Â  Â  document.getElementById('result').textContent = decodedText;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // 2. Reset image display before starting the check
Â  Â  Â  Â  Â  Â  IMAGE_EL.style.display = 'none';
Â  Â  Â  Â  Â  Â  IMAGE_EL.alt = 'Scanning completed, attempting to load image...';

Â  Â  Â  Â  Â  Â  // 3. Start the image check and fallback logic
Â  Â  Â  Â  Â  Â  checkAndDisplayImage(decodedText, decodedText); 
Â  Â  Â  Â  }

Â  Â  Â  Â  function onScanFailure(error) {
Â  Â  Â  Â  Â  Â  // console.warn(`Code scan error = ${error}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- BARCODE-ONLY CONFIGURATION ---
Â  Â  Â  Â  // List of common 1D barcode formats to support, excluding QR_CODE
Â  Â  Â  Â  const barcodeOnlyConfig = {
Â  Â  Â  Â  Â  Â  fps: 10, 
Â  Â  Â  Â  Â  Â  qrbox: {width: 250, height: 100}, // Adjusted box for horizontal barcodes
Â  Â  Â  Â  Â  Â  formatsToSupport: [
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.CODE_128,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.EAN_13,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.EAN_8,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.CODE_39,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.ITF,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.UPC_A,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.UPC_E,
Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.CODABAR,
Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  };
        
Â  Â  Â  Â  // Create a new scanner instance
Â  Â  Â  Â  var html5QrcodeScanner = new Html5QrcodeScanner(
Â  Â  Â  Â  Â  Â  "reader", // The ID of the HTML element where the scanner should appear
Â  Â  Â  Â  Â  Â  barcodeOnlyConfig, // Use the new configuration object
Â  Â  Â  Â  Â  Â  /* verbose= */ false
Â  Â  Â  Â  );

Â  Â  Â  Â  // --- 2. Start the Scanner ---
Â  Â  Â  Â  html5QrcodeScanner.render(onScanSuccess, onScanFailure);

Â  Â  </script>

</body>
</html>
