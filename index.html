<!DOCTYPE html>
<html>
<head>
    <title>Responsive Online Barcode & QR Scanner</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
    
    <style>
        /* Base styles for a clean, centered look on all devices */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 10px; 
            background-color: #f4f4f9;
            margin: 0;
        }
        
        /* Heading styles */
        h1 {
            color: #2c3e50;
            font-size: 1.5em; 
            margin-bottom: 5px;
        }
        h3 {
            color: #34495e;
            font-size: 1.2em;
        }

        /* 3. RESPONSIVE CONTAINER: Scales on mobile, limits size on desktop */
        #reader {
            width: 95%; /* Takes most of the screen width on mobile */
            max-width: 500px; /* Limits the size on large desktop screens */
            margin: 20px auto;
            border: 2px solid #3498db;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Ensures the video element inside the reader container scales correctly */
        #reader video {
            width: 100% !important;
            height: auto !important;
        }

        #result-container {
            margin-top: 30px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 5px;
            max-width: 500px;
            margin: 30px auto;
        }
        
        #result {
            font-weight: bold;
            color: #2c3e50;
            word-break: break-all;
            min-height: 20px;
        }

        /* Media Query for larger desktop screens */
        @media (min-width: 768px) {
            body {
                padding: 40px;
            }
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>

    <h1>ðŸš€ Online Barcode & QR Scanner</h1>
    <p>Scan a code using your device's camera.</p>

    <div id="reader"></div>

    <div id="result-container">
        <h3>Decoded Result:</h3>
        <p id="result">Awaiting scan...</p>
    </div>

    <script>
        // --- 4. JavaScript Logic: Handlers and Initialization ---
        
        function onScanSuccess(decodedText, decodedResult) {
            // Function to run on successful scan
            document.getElementById('result').textContent = decodedText;
            
            // OPTIONAL: Uncomment the line below to stop scanning after the first successful scan
            /*
            html5QrcodeScanner.clear().catch(error => { 
                console.error("Failed to clear scanner:", error); 
            });
            */
        }

        function onScanFailure(error) {
            // Function to run on scanning failure (e.g., no code in view)
            // It runs frequently, so we keep this quiet.
        }

        // Create a new scanner instance targeting the 'reader' element
        const html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", 
            { 
                fps: 10, 
                qrbox: {width: 250, height: 250}, 
                rememberLastUsedCamera: true
            },
            /* verbose= */ false
        );

        // This attempts to get a list of available cameras first
        Html5Qrcode.getCameras().then(devices => {
            if (devices && devices.length) {
                // If cameras are found, proceed to render the scanner.
                // NOTE: This call automatically prompts for camera permission (requires HTTPS).
                html5QrcodeScanner.render(onScanSuccess, onScanFailure);
            } else {
                // Handle case where no cameras are physically available
                document.getElementById('result').textContent = "No camera found on this device.";
                console.error("No camera devices found.");
            }
        }).catch(err => {
            // This catches permission errors or issues when run locally (file://)
            document.getElementById('result').textContent = "ERROR: Could not start camera. Please ensure the site is loaded via a secure (HTTPS) web address, not from a local file.";
            console.error("Camera access failed:", err);
        });

    </script>

</body>
</html>
